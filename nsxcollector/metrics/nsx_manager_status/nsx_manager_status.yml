# polling parameters
# each item is a polling type of commands
# need the call name
# polling interval
# mode: can be status, stats or config
# nodes: define on what node the call must be applied
# if the list is empty, it will take alls nodes, and all interfaces
# if there is 'Manager' in node, it's a call applied to the nsx manager
# exemple: 
# components: 
#   - 
#     name: Edge-1,        
#     interfaces: ['fp-eth0']
#   - 
#     name: Edge-2,
#     type: edgenode
#     interfaces: ['fp-eth1, fp-eth2']
# or for all interfaces of an node
# nodes:
#   -
#     name: ESX-1:
#     interfaces: []


polling:
  -
    call: ReadClusterStatus
    polling: 30
    influx_queries:
      -
        measurement: CC-Status
        tags: ['cluster']
        search_values:
          - 
            key: 'status'
            values_in_json: ["control_cluster_status", "status"]
      -
        measurement: MC-Status
        tags: ['cluster']
        search_values:
          - 
            key: 'status'
            values_in_json: ["mgmt_cluster_status", "status"]
      -
        measurement: MC-Nodes
        tags: ['cluster']
        search_values:
          - 
            key: 'UP'
            values_in_json: ["mgmt_cluster_status", "online_nodes"]
          - 
            key: 'DOWN'
            values_in_json: ["mgmt_cluster_status", "offline_nodes"]
  -
    call: GetBackupOverview
    polling: 30
    influx_queries:
      -
        measurement: BKP-Config
        tags: ['cluster']
        search_values:
          - 
            key: 'enabled'
            values_in_json: ["backup_enabled"]
      -
        measurement: BKP-LastStatus
        tags: ['cluster']
        search_values:
          - 
            key: 'status'
            values_in_json: ["cluster_backup_statuses", 0, "success"]
      -
        measurement: BKP-Schedule
        tags: ['cluster']
        search_values:
          - 
            key: 'schedule'
            values_in_json: ["backup_schedule", "resource_type"]


grafana:
  panel_parameters:
    dashboard: NSX Managers
    name: NSX Manager Status
    suffix_name: ''
    type: 'stat'

